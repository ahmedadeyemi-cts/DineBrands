<!DOCTYPE html>
<html>
<head>
    <title>Launching Emplifi...</title>

    <script>
        window.onload = function () {
            const params = new URLSearchParams(window.location.search);
            const ani = params.get("ani");
            const email = params.get("email");

            if (!ani || !email) {
                document.body.innerHTML = "Missing ANI or Email";
                return;
            }

            // Build POST payload
            const form = document.createElement("form");
            form.method = "POST";
            form.action = "https://USECASEPOP054A.myastutesolutions.com/api/screen";
            form.target = "_self";

            const payload = {
                secret_key: "TrainSecret@a29m!",
                company_id: "SYS",
                b05_code: "800",
                phone: ani,
                c06_code: "0000",
                user_code_field: {
                    uxx_code: "u03_code",
                    user_code_identity: email
                }
            };

            Object.keys(payload).forEach(key => {
                if (typeof payload[key] === "object") {
                    Object.keys(payload[key]).forEach(sub => {
                        const input = document.createElement("input");
                        input.type = "hidden";
                        input.name = `user_code_field[${sub}]`;
                        input.value = payload[key][sub];
                        form.appendChild(input);
                    });
                } else {
                    const input = document.createElement("input");
                    input.type = "hidden";
                    input.name = key;
                    input.value = payload[key];
                    form.appendChild(input);
                }
            });

            document.body.appendChild(form);
            form.submit();
        };
    </script>
</head>

<body>
    <h3>Launching Emplifi...</h3>
</body>
</html>
